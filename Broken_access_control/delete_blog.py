import requests

# Replace these values with your own
BWAPP_URL = "http://10.0.2.5/bWAPP"
USERNAME = "bee"
PASSWORD = "bug"
ENTRY_ID_TO_DELETE = 2  # The ID of the blog entry you want to delete

session = requests.Session()

def login():
    login_url = f"{BWAPP_URL}/login.php"
    data = {
        'login': USERNAME,
        'password': PASSWORD,
        'form': 'submit'
    }
    try:
        response = session.post(login_url, data=data, timeout=10)
        if response.status_code == 200 and ("Welcome" in response.text or "Logout" in response.text):
            print("[+] Logged in successfully.")
            return True
        else:
            print("[-] Failed to log in.")
            return False
    except requests.exceptions.RequestException as e:
        print(f"[-] Login request failed: {e}")
        return False

def delete_blog_entry(entry_id):
    delete_url = f"{BWAPP_URL}/xss_stored_1.php"
    data = {
        'entry_delete': 'on',
        'entry_id': entry_id,  # Assuming this parameter is used to identify the entry
        'form': 'submit'
    }
    try:
        response = session.post(delete_url, data=data, timeout=10)
        if response.status_code == 200 and "All your entries were deleted!" in response.text:
            print(f"[+] Blog entry {entry_id} deleted successfully.")
        else:
            print(f"[-] Failed to delete blog entry {entry_id}. Status code: {response.status_code}")
            print(response.text)
    except requests.exceptions.RequestException as e:
        print(f"[-] Request to delete blog entry failed: {e}")

if __name__ == "__main__":
    if login():
        delete_blog_entry(entry_id=ENTRY_ID_TO_DELETE)
    else:
        print("[-] Exiting script due to failed login.")
