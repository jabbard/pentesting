import requests

# Replace these values with your own
BWAPP_URL = "http://10.0.2.5/bWAPP"
USERNAME = "bee"
PASSWORD = "bug"

session = requests.Session()

def login():
    login_url = f"{BWAPP_URL}/login.php"
    data = {
        'login': USERNAME,
        'password': PASSWORD,
        'form': 'submit'
    }
    try:
        response = session.post(login_url, data=data, timeout=10)
        if response.status_code == 200 and ("Welcome" in response.text or "Logout" in response.text):
            print("[+] Logged in successfully.")
            return True
        else:
            print("[-] Failed to log in.")
            return False
    except requests.exceptions.RequestException as e:
        print(f"[-] Login request failed: {e}")
        return False

def change_security_level(new_level):
    set_level_url = f"{BWAPP_URL}/security_level_set.php"
    data = {
        'security_level': new_level,
        'form': 'submit'
    }
    try:
        response = session.post(set_level_url, data=data, timeout=10)
        if response.status_code == 200 and "Current: <b>" in response.text:
            print(f"[+] Security level changed to {new_level}.")
        else:
            print(f"[-] Failed to change security level to {new_level}.")
    except requests.exceptions.RequestException as e:
        print(f"[-] Request to change security level failed: {e}")

if __name__ == "__main__":
    if login():
        # Change security level to high (2)
        change_security_level(new_level=2)
    else:
        print("[-] Exiting script due to failed login.")
