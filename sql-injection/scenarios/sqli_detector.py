import subprocess

def run_sqlmap(url, data=None, cookies=None):
    """
    Runs sqlmap on the given URL to detect SQL injection vulnerabilities.

    :param url: The target URL.
    :param data: (Optional) The POST data for the request.
    :param cookies: (Optional) The cookies for the request.
    """
    command = ["sqlmap", "-u", url, "--batch", "--forms"]

    if data:
        command.extend(["--data", data])
    if cookies:
        command.extend(["--cookie", cookies])

    try:
        # Run the sqlmap command and capture the output
        result = subprocess.run(command, capture_output=True, text=True)

        # Print the output
        print("Sqlmap Output:")
        print(result.stdout)
    except Exception as e:
        print(f"An error occurred: {e}")

def main():
    # Prompt the user for input
    target_url = input("Enter the target URL: ")
    post_data = input("Enter the POST data (leave blank if not applicable): ")
    cookie_data = input("Enter the cookies (leave blank if not applicable): ")

    # Call the function to run sqlmap
    run_sqlmap(target_url, data=post_data if post_data else None, cookies=cookie_data if cookie_data else None)

if __name__ == "__main__":
    main()
