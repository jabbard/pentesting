# User Manual for PentestPal

## Description

PentestPal is an all-in-one pentesting tool designed to assess whether the provided web applications are vulnerable to specific security vulnerabilities. It streamlines the process of identifying weaknesses and ensures comprehensive testing against a range of potential security threats.

## Contributors

- Pradhumna Dhungana
- Susanta Bhujel
- Bhavya

## List of Vulnerabilities

PentestPal tests for the following vulnerabilities:
- **SSRF (Server-Side Request Forgery)**
- **CSRF (Cross-Site Request Forgery)**
- **Unauthorized File Upload**
- **Deserialization**

## Steps to Run the Application

1. Open a terminal on your project.
2. Navigate to the `gui` folder by executing:
   ```bash
   cd gui

3. Run the application with
    ```bash
    python3 app.py

4. Then go to http://localhost:5000

## Vulnerabilities

### SSRF (Server-Side Request Forgery)

**Definition:** SSRF is a vulnerability that allows an attacker to send requests from the server to internal or external resources, which can lead to information disclosure, server-side request manipulation, or even remote code execution.

**URL:** `http://localhost:8000/ssrf`

**Vulnerable App:** Self-created simple API parser

## Test Cases

1. **Sending HTML Request through Loopback IP:** Test by sending requests to different commonly used ports on `localhost` to see if there are any other applications running on the server.
2. **Fetching Content of Local Files:** Attempt to retrieve the content of various local files to check if the server can access sensitive files.
3. **Fetching Metadata of Common Cloud-Based Services:** Try to access metadata from cloud-based services (e.g., AWS, GCP) to see if the server is leaking any cloud service metadata.

## CSRF (Cross-Site Request Forgery)

**Definition:** CSRF is a vulnerability that tricks a user into submitting an unwanted action on a web application where they are authenticated, leading to unauthorized actions being performed on their behalf.

**URL:** `http://localhost:8000/csrf`

**Vulnerable App:** DVWA (Damn Vulnerable Web Application)

## Test Cases

1. **Changing the Security Level of DVWA Application:** Test by submitting a request to change the security level without the user's consent.
2. **Changing the Password of Logged-In User at Low Security:** Attempt to change the password of a logged-in user on the low security setting, where no anti-CSRF measures are implemented.
3. **Changing the Password of Logged-In User at Medium Security:** Perform the same attack as above but include the `Referer` header in the request to bypass medium-level security.
4. **Changing the Password of Logged-In User at High Security:** Fetch the CSRF token from the page and include it in the request to change the user's password, bypassing high-level security.


## Unauthorized File Upload

**Definition:** Unauthorized file upload vulnerabilities allow attackers to upload malicious files to the server, leading to code execution, data exposure, or other harmful actions.

**URL:** `http://localhost:8000/ufi`

**Vulnerable App:** Online Piggy

## Test Cases

1. **Upload PHP File for Command Execution:** Upload a PHP file that takes a Linux command as a URL parameter (`cmd`) and executes the command on the server.
2. **Upload PHP File for File Disclosure:** Upload a PHP file that accepts local file names as input and displays the content of the specified files.
3. **Upload Bash Script:** Upload a bash script that, when executed, creates a new text file on the server.


## Deserialization

**Definition:** Deserialization vulnerabilities occur when untrusted data is used to control the execution flow of a program during the deserialization process, potentially leading to remote code execution or other malicious actions.

**URL:** `http://localhost:8000/deserialization`

**Vulnerable App:** Self-Created To-Do Listing App in Django

## Test Cases

1. **Malicious Code Execution with `curl`:** Write a malicious piece of code that, when serialized or deserialized, triggers a `curl` command to download a file from the internet, which remains inside the system.
2. **Script Execution to Create a Text File:** A malicious script is executed that creates a text file on the server.
3. **No Operation (NOP):** A No Operation command is printed, which can be checked in the server logs.
